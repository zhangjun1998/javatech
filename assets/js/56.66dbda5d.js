(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{305:function(t,a,s){"use strict";s.r(a);var e=s(2),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"tomcat-åº”ç”¨æŒ‡å—"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-åº”ç”¨æŒ‡å—"}},[t._v("#")]),t._v(" Tomcat åº”ç”¨æŒ‡å—")]),t._v(" "),s("blockquote",[s("p",[t._v("ğŸ ç‰ˆæœ¬è¯´æ˜")]),t._v(" "),s("p",[t._v("å½“å‰æœ€æ–°ç‰ˆæœ¬ï¼šTomcat 8.5.24")]),t._v(" "),s("p",[t._v("ç¯å¢ƒè¦æ±‚ï¼šJDK7+")])]),t._v(" "),s("h2",{attrs:{id:"ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç®€ä»‹"}},[t._v("#")]),t._v(" ç®€ä»‹")]),t._v(" "),s("h3",{attrs:{id:"tomcat-æ˜¯ä»€ä¹ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" Tomcat æ˜¯ä»€ä¹ˆ")]),t._v(" "),s("p",[t._v("Tomcat æ˜¯ç”± Apache å¼€å‘çš„ä¸€ä¸ª Servlet å®¹å™¨ï¼Œå®ç°äº†å¯¹ Servlet å’Œ JSP çš„æ”¯æŒï¼Œå¹¶æä¾›äº†ä½œä¸º Web æœåŠ¡å™¨çš„ä¸€äº›ç‰¹æœ‰åŠŸèƒ½ï¼Œå¦‚ Tomcat ç®¡ç†å’Œæ§åˆ¶å¹³å°ã€å®‰å…¨åŸŸç®¡ç†å’Œ Tomcat é˜€ç­‰ã€‚")]),t._v(" "),s("p",[t._v("ç”±äº Tomcat æœ¬èº«ä¹Ÿå†…å«äº†ä¸€ä¸ª HTTP æœåŠ¡å™¨ï¼Œå®ƒä¹Ÿå¯ä»¥è¢«è§†ä½œä¸€ä¸ªå•ç‹¬çš„ Web æœåŠ¡å™¨ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å°† Tomcat å’Œ Apache HTTP æœåŠ¡å™¨æ··æ·†ï¼ŒApache HTTP æœåŠ¡å™¨æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€å®ç°çš„ HTTP Web æœåŠ¡å™¨ï¼›è¿™ä¸¤ä¸ª HTTP web server ä¸æ˜¯æ†ç»‘åœ¨ä¸€èµ·çš„ã€‚Tomcat åŒ…å«äº†ä¸€ä¸ªé…ç½®ç®¡ç†å·¥å…·ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç¼–è¾‘ XML æ ¼å¼çš„é…ç½®æ–‡ä»¶æ¥è¿›è¡Œé…ç½®ã€‚")]),t._v(" "),s("h3",{attrs:{id:"tomcat-é‡è¦ç›®å½•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-é‡è¦ç›®å½•"}},[t._v("#")]),t._v(" Tomcat é‡è¦ç›®å½•")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("/bin")]),t._v(" - Tomcat è„šæœ¬å­˜æ”¾ç›®å½•ï¼ˆå¦‚å¯åŠ¨ã€å…³é—­è„šæœ¬ï¼‰ã€‚ "),s("code",[t._v("*.sh")]),t._v(" æ–‡ä»¶ç”¨äº Unix ç³»ç»Ÿï¼› "),s("code",[t._v("*.bat")]),t._v(" æ–‡ä»¶ç”¨äº Windows ç³»ç»Ÿã€‚")]),t._v(" "),s("li",[s("strong",[t._v("/conf")]),t._v(" - Tomcat é…ç½®æ–‡ä»¶ç›®å½•ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("/logs")]),t._v(" - Tomcat é»˜è®¤æ—¥å¿—ç›®å½•ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("/webapps")]),t._v(" - webapp è¿è¡Œçš„ç›®å½•ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"web-å·¥ç¨‹å‘å¸ƒç›®å½•ç»“æ„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-å·¥ç¨‹å‘å¸ƒç›®å½•ç»“æ„"}},[t._v("#")]),t._v(" web å·¥ç¨‹å‘å¸ƒç›®å½•ç»“æ„")]),t._v(" "),s("p",[t._v("ä¸€èˆ¬ web é¡¹ç›®è·¯å¾„ç»“æ„")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("|-- webapp                         # ç«™ç‚¹æ ¹ç›®å½•\n    |-- META-INF                   # META-INF ç›®å½•\n    |   `-- MANIFEST.MF            # é…ç½®æ¸…å•æ–‡ä»¶\n    |-- WEB-INF                    # WEB-INF ç›®å½•\n    |   |-- classes                # classæ–‡ä»¶ç›®å½•\n    |   |   |-- *.class            # ç¨‹åºéœ€è¦çš„ class æ–‡ä»¶\n    |   |   `-- *.xml              # ç¨‹åºéœ€è¦çš„ xml æ–‡ä»¶\n    |   |-- lib                    # åº“æ–‡ä»¶å¤¹\n    |   |   `-- *.jar              # ç¨‹åºéœ€è¦çš„ jar åŒ…\n    |   `-- web.xml                # Webåº”ç”¨ç¨‹åºçš„éƒ¨ç½²æè¿°æ–‡ä»¶\n    |-- <userdir>                  # è‡ªå®šä¹‰çš„ç›®å½•\n    |-- <userfiles>                # è‡ªå®šä¹‰çš„èµ„æºæ–‡ä»¶\n")])])]),s("p",[s("code",[t._v("webapp")]),t._v("ï¼šå·¥ç¨‹å‘å¸ƒæ–‡ä»¶å¤¹ã€‚å…¶å®æ¯ä¸ª war åŒ…éƒ½å¯ä»¥è§†ä¸º webapp çš„å‹ç¼©åŒ…ã€‚")]),t._v(" "),s("p",[s("code",[t._v("META-INF")]),t._v("ï¼šMETA-INF ç›®å½•ç”¨äºå­˜æ”¾å·¥ç¨‹è‡ªèº«ç›¸å…³çš„ä¸€äº›ä¿¡æ¯ï¼Œå…ƒæ–‡ä»¶ä¿¡æ¯ï¼Œé€šå¸¸ç”±å¼€å‘å·¥å…·ï¼Œç¯å¢ƒè‡ªåŠ¨ç”Ÿæˆã€‚")]),t._v(" "),s("p",[s("code",[t._v("WEB-INF")]),t._v("ï¼šJava web åº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚æ‰€è°“å®‰å…¨å°±æ˜¯å®¢æˆ·ç«¯æ— æ³•è®¿é—®ï¼Œåªæœ‰æœåŠ¡ç«¯å¯ä»¥è®¿é—®çš„ç›®å½•ã€‚")]),t._v(" "),s("p",[s("code",[t._v("/WEB-INF/classes")]),t._v("ï¼šå­˜æ”¾ç¨‹åºæ‰€éœ€è¦çš„æ‰€æœ‰ Java class æ–‡ä»¶ã€‚")]),t._v(" "),s("p",[s("code",[t._v("/WEB-INF/lib")]),t._v("ï¼šå­˜æ”¾ç¨‹åºæ‰€éœ€è¦çš„æ‰€æœ‰ jar æ–‡ä»¶ã€‚")]),t._v(" "),s("p",[s("code",[t._v("/WEB-INF/web.xml")]),t._v("ï¼šweb åº”ç”¨çš„éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚å®ƒæ˜¯å·¥ç¨‹ä¸­æœ€é‡è¦çš„é…ç½®æ–‡ä»¶ï¼Œå®ƒæè¿°äº† servlet å’Œç»„æˆåº”ç”¨çš„å…¶å®ƒç»„ä»¶ï¼Œä»¥åŠåº”ç”¨åˆå§‹åŒ–å‚æ•°ã€å®‰å…¨ç®¡ç†çº¦æŸç­‰ã€‚")]),t._v(" "),s("h2",{attrs:{id:"quickstart"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#quickstart"}},[t._v("#")]),t._v(" QuickStart")]),t._v(" "),s("h3",{attrs:{id:"å®‰è£…"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®‰è£…"}},[t._v("#")]),t._v(" å®‰è£…")]),t._v(" "),s("p",[s("strong",[t._v("å‰ææ¡ä»¶")])]),t._v(" "),s("p",[t._v("Tomcat 8.5 è¦æ±‚ JDK ç‰ˆæœ¬ä¸º 1.7 ä»¥ä¸Šã€‚")]),t._v(" "),s("p",[t._v("è¿›å…¥ "),s("a",{attrs:{href:"https://tomcat.apache.org/download-80.cgi",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat å®˜æ–¹ä¸‹è½½åœ°å€"),s("OutboundLink")],1),t._v(" é€‰æ‹©åˆé€‚ç‰ˆæœ¬ä¸‹è½½ï¼Œå¹¶è§£å‹åˆ°æœ¬åœ°ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("Windows")])]),t._v(" "),s("p",[t._v("æ·»åŠ ç¯å¢ƒå˜é‡ "),s("code",[t._v("CATALINA_HOME")]),t._v(" ï¼Œå€¼ä¸º Tomcat çš„å®‰è£…è·¯å¾„ã€‚")]),t._v(" "),s("p",[t._v("è¿›å…¥å®‰è£…ç›®å½•ä¸‹çš„ bin ç›®å½•ï¼Œè¿è¡Œ startup.bat æ–‡ä»¶ï¼Œå¯åŠ¨ Tomcat")]),t._v(" "),s("p",[s("strong",[t._v("Linux / Unix")])]),t._v(" "),s("p",[t._v("ä¸‹é¢çš„ç¤ºä¾‹ä»¥ 8.5.24 ç‰ˆæœ¬ä¸ºä¾‹ï¼ŒåŒ…å«äº†ä¸‹è½½ã€è§£å‹ã€å¯åŠ¨æ“ä½œã€‚")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ä¸‹è½½è§£å‹åˆ°æœ¬åœ°")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.24/bin/apache-tomcat-8.5.24.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -zxf apache-tomcat-8.5.24.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å¯åŠ¨ Tomcat")]),t._v("\n./apache-tomcat-8.5.24/bin/startup.sh\n")])])]),s("p",[t._v("å¯åŠ¨åï¼Œè®¿é—® "),s("code",[t._v("http://localhost:8080")]),t._v(" ï¼Œå¯ä»¥çœ‹åˆ° Tomcat å®‰è£…æˆåŠŸçš„æµ‹è¯•é¡µé¢ã€‚")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/tomcat.png!zp",alt:"img"}})]),t._v(" "),s("h3",{attrs:{id:"é…ç½®"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é…ç½®"}},[t._v("#")]),t._v(" é…ç½®")]),t._v(" "),s("p",[t._v("æœ¬èŠ‚å°†åˆ—ä¸¾ä¸€äº›é‡è¦ã€å¸¸è§çš„é…ç½®é¡¹ã€‚è¯¦ç»†çš„ Tomcat8 é…ç½®å¯ä»¥å‚è€ƒ "),s("a",{attrs:{href:"http://tomcat.apache.org/tomcat-8.5-doc/config/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat 8 é…ç½®å®˜æ–¹å‚è€ƒæ–‡æ¡£"),s("OutboundLink")],1),t._v(" ã€‚")]),t._v(" "),s("h4",{attrs:{id:"server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#server"}},[t._v("#")]),t._v(" Server")]),t._v(" "),s("blockquote",[s("p",[t._v("Server å…ƒç´ è¡¨ç¤ºæ•´ä¸ª Catalina servlet å®¹å™¨ã€‚")]),t._v(" "),s("p",[t._v("å› æ­¤ï¼Œå®ƒå¿…é¡»æ˜¯ "),s("code",[t._v("conf/server.xml")]),t._v(" é…ç½®æ–‡ä»¶ä¸­çš„æ ¹å…ƒç´ ã€‚å®ƒçš„å±æ€§ä»£è¡¨äº†æ•´ä¸ª servlet å®¹å™¨çš„ç‰¹æ€§ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("æè¿°")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("className")]),t._v(" "),s("td",[t._v("è¿™ä¸ªç±»å¿…é¡»å®ç° org.apache.catalina.Server æ¥å£ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ org.apache.catalina.core.StandardServer")])]),t._v(" "),s("tr",[s("td",[t._v("address")]),t._v(" "),s("td",[t._v("æœåŠ¡å™¨ç­‰å¾…å…³æœºå‘½ä»¤çš„ TCP / IP åœ°å€ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šåœ°å€ï¼Œåˆ™ä½¿ç”¨ localhostã€‚")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("port")]),t._v(" "),s("td",[t._v("æœåŠ¡å™¨ç­‰å¾…å…³æœºå‘½ä»¤çš„ TCP / IP ç«¯å£å·ã€‚è®¾ç½®ä¸º-1 ä»¥ç¦ç”¨å…³é—­ç«¯å£ã€‚")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("shutdown")]),t._v(" "),s("td",[t._v("å¿…é¡»é€šè¿‡ TCP / IP è¿æ¥æ¥æ”¶åˆ°æŒ‡å®šç«¯å£å·çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œä»¥å…³é—­ Tomcatã€‚")]),t._v(" "),s("td")])])]),t._v(" "),s("h4",{attrs:{id:"service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[t._v("#")]),t._v(" Service")]),t._v(" "),s("blockquote",[s("p",[t._v("Service å…ƒç´ è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥å™¨ç»„ä»¶çš„ç»„åˆï¼Œè¿™äº›ç»„ä»¶å…±äº«ä¸€ä¸ªç”¨äºå¤„ç†ä¼ å…¥è¯·æ±‚çš„å¼•æ“ç»„ä»¶ã€‚Server ä¸­å¯ä»¥æœ‰å¤šä¸ª Serviceã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("æè¿°")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("className")]),t._v(" "),s("td",[t._v("è¿™ä¸ªç±»å¿…é¡»å®ç°"),s("code",[t._v("org.apache.catalina.Service")]),t._v("æ¥å£ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ "),s("code",[t._v("org.apache.catalina.core.StandardService")])])]),t._v(" "),s("tr",[s("td",[t._v("name")]),t._v(" "),s("td",[t._v("æ­¤æœåŠ¡çš„æ˜¾ç¤ºåç§°ï¼Œå¦‚æœæ‚¨ä½¿ç”¨æ ‡å‡† Catalina ç»„ä»¶ï¼Œå°†åŒ…å«åœ¨æ—¥å¿—æ¶ˆæ¯ä¸­ã€‚ä¸ç‰¹å®šæœåŠ¡å™¨å…³è”çš„æ¯ä¸ªæœåŠ¡çš„åç§°å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚")]),t._v(" "),s("td")])])]),t._v(" "),s("p",[s("strong",[t._v("å®ä¾‹ - "),s("code",[t._v("conf/server.xml")]),t._v(" é…ç½®æ–‡ä»¶ç¤ºä¾‹")])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="UTF-8"?>')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Server")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("8080"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("shutdown")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("SHUTDOWN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  ...\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h4",{attrs:{id:"executor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#executor"}},[t._v("#")]),t._v(" Executor")]),t._v(" "),s("blockquote",[s("p",[t._v("Executor è¡¨ç¤ºå¯ä»¥åœ¨ Tomcat ä¸­çš„ç»„ä»¶ä¹‹é—´å…±äº«çš„çº¿ç¨‹æ± ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("æè¿°")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("className")]),t._v(" "),s("td",[t._v("è¿™ä¸ªç±»å¿…é¡»å®ç°"),s("code",[t._v("org.apache.catalina.Executor")]),t._v("æ¥å£ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ "),s("code",[t._v("org.apache.catalina.core.StandardThreadExecutor")])])]),t._v(" "),s("tr",[s("td",[t._v("name")]),t._v(" "),s("td",[t._v("çº¿ç¨‹æ± åç§°ã€‚")]),t._v(" "),s("td",[t._v("è¦æ±‚å”¯ä¸€, ä¾› Connector å…ƒç´ çš„ executor å±æ€§ä½¿ç”¨")])]),t._v(" "),s("tr",[s("td",[t._v("namePrefix")]),t._v(" "),s("td",[t._v("çº¿ç¨‹åç§°å‰ç¼€ã€‚")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("maxThreads")]),t._v(" "),s("td",[t._v("æœ€å¤§æ´»è·ƒçº¿ç¨‹æ•°ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ 200")])]),t._v(" "),s("tr",[s("td",[t._v("minSpareThreads")]),t._v(" "),s("td",[t._v("æœ€å°æ´»è·ƒçº¿ç¨‹æ•°ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ 25")])]),t._v(" "),s("tr",[s("td",[t._v("maxIdleTime")]),t._v(" "),s("td",[t._v("å½“å‰æ´»è·ƒçº¿ç¨‹å¤§äº minSpareThreads æ—¶,ç©ºé—²çº¿ç¨‹å…³é—­çš„ç­‰å¾…æœ€å¤§æ—¶é—´ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ 60000ms")])]),t._v(" "),s("tr",[s("td",[t._v("maxQueueSize")]),t._v(" "),s("td",[t._v("çº¿ç¨‹æ± æ»¡æƒ…å†µä¸‹çš„è¯·æ±‚æ’é˜Ÿå¤§å°ã€‚")]),t._v(" "),s("td",[t._v("é»˜è®¤ Integer.MAX_VALUE")])])])]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Service")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("xxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Executor")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tomcatThreadPool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("namePrefix")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("catalina-exec-"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("maxThreads")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("300"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("minSpareThreads")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("25"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h4",{attrs:{id:"connector"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connector"}},[t._v("#")]),t._v(" Connector")]),t._v(" "),s("blockquote",[s("p",[t._v("Connector ä»£è¡¨è¿æ¥ç»„ä»¶ã€‚Tomcat æ”¯æŒä¸‰ç§åè®®ï¼šHTTP/1.1ã€HTTP/2.0ã€AJPã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("è¯´æ˜")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("asyncTimeout")]),t._v(" "),s("td",[t._v("Servlet3.0 è§„èŒƒä¸­çš„å¼‚æ­¥è¯·æ±‚è¶…æ—¶")]),t._v(" "),s("td",[t._v("é»˜è®¤ 30s")])]),t._v(" "),s("tr",[s("td",[t._v("port")]),t._v(" "),s("td",[t._v("è¯·æ±‚è¿æ¥çš„ TCP Port")]),t._v(" "),s("td",[t._v("è®¾ç½®ä¸º 0,åˆ™ä¼šéšæœºé€‰å–ä¸€ä¸ªæœªå ç”¨çš„ç«¯å£å·")])]),t._v(" "),s("tr",[s("td",[t._v("protocol")]),t._v(" "),s("td",[t._v("åè®®. ä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸º HTTP/1.1,è¿™ç§æƒ…å†µä¸‹è¿æ¥æ¨¡å‹ä¼šåœ¨ NIO å’Œ APR/native ä¸­è‡ªåŠ¨æ ¹æ®é…ç½®é€‰æ‹©")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("URIEncoding")]),t._v(" "),s("td",[t._v("å¯¹ URI çš„ç¼–ç æ–¹å¼.")]),t._v(" "),s("td",[t._v("å¦‚æœè®¾ç½®ç³»ç»Ÿå˜é‡ org.apache.catalina.STRICT_SERVLET_COMPLIANCE ä¸º true,ä½¿ç”¨ ISO-8859-1 ç¼–ç ;å¦‚æœæœªè®¾ç½®æ­¤ç³»ç»Ÿå˜é‡ä¸”æœªè®¾ç½®æ­¤å±æ€§, ä½¿ç”¨ UTF-8 ç¼–ç ")])]),t._v(" "),s("tr",[s("td",[t._v("useBodyEncodingForURI")]),t._v(" "),s("td",[t._v("æ˜¯å¦é‡‡ç”¨æŒ‡å®šçš„ contentType è€Œä¸æ˜¯ URIEncoding æ¥ç¼–ç  URI ä¸­çš„è¯·æ±‚å‚æ•°")]),t._v(" "),s("td")])])]),t._v(" "),s("p",[t._v("ä»¥ä¸‹å±æ€§åœ¨æ ‡å‡†çš„ Connector(NIO, NIO2 å’Œ APR/native)ä¸­æœ‰æ•ˆ:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("è¯´æ˜")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("acceptCount")]),t._v(" "),s("td",[t._v("å½“æœ€å¤§è¯·æ±‚è¿æ¥ maxConnections æ»¡æ—¶çš„æœ€å¤§æ’é˜Ÿå¤§å°")]),t._v(" "),s("td",[t._v("é»˜è®¤ 100,æ³¨æ„æ­¤å±æ€§å’Œ Executor ä¸­å±æ€§ maxQueueSize çš„åŒºåˆ«.è¿™ä¸ªæŒ‡çš„æ˜¯è¯·æ±‚è¿æ¥æ»¡æ—¶çš„å †æ ˆå¤§å°,Executor çš„ maxQueueSize æŒ‡çš„æ˜¯å¤„ç†çº¿ç¨‹æ»¡æ—¶çš„å †æ ˆå¤§å°")])]),t._v(" "),s("tr",[s("td",[t._v("connectionTimeout")]),t._v(" "),s("td",[t._v("è¯·æ±‚è¿æ¥è¶…æ—¶")]),t._v(" "),s("td",[t._v("é»˜è®¤ 60000ms")])]),t._v(" "),s("tr",[s("td",[t._v("executor")]),t._v(" "),s("td",[t._v("æŒ‡å®šé…ç½®çš„çº¿ç¨‹æ± åç§°")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("keepAliveTimeout")]),t._v(" "),s("td",[t._v("keeAlive è¶…æ—¶æ—¶é—´")]),t._v(" "),s("td",[t._v("é»˜è®¤å€¼ä¸º connectionTimeout é…ç½®å€¼.-1 è¡¨ç¤ºä¸è¶…æ—¶")])]),t._v(" "),s("tr",[s("td",[t._v("maxConnections")]),t._v(" "),s("td",[t._v("æœ€å¤§è¿æ¥æ•°")]),t._v(" "),s("td",[t._v("è¿æ¥æ»¡æ—¶åç»­è¿æ¥æ”¾å…¥æœ€å¤§ä¸º acceptCount çš„é˜Ÿåˆ—ä¸­. å¯¹ NIO å’Œ NIO2 è¿æ¥,é»˜è®¤å€¼ä¸º 10000;å¯¹ APR/native,é»˜è®¤å€¼ä¸º 8192")])]),t._v(" "),s("tr",[s("td",[t._v("maxThreads")]),t._v(" "),s("td",[t._v("å¦‚æœæŒ‡å®šäº† Executor, æ­¤å±æ€§å¿½ç•¥;å¦åˆ™ä¸º Connector åˆ›å»ºçš„å†…éƒ¨çº¿ç¨‹æ± æœ€å¤§å€¼")]),t._v(" "),s("td",[t._v("é»˜è®¤ 200")])]),t._v(" "),s("tr",[s("td",[t._v("minSpareThreads")]),t._v(" "),s("td",[t._v("å¦‚æœæŒ‡å®šäº† Executor, æ­¤å±æ€§å¿½ç•¥;å¦åˆ™ä¸º Connector åˆ›å»ºçº¿ç¨‹æ± çš„æœ€å°æ´»è·ƒçº¿ç¨‹æ•°")]),t._v(" "),s("td",[t._v("é»˜è®¤ 10")])]),t._v(" "),s("tr",[s("td",[t._v("processorCache")]),t._v(" "),s("td",[t._v("åè®®å¤„ç†å™¨ç¼“å­˜ Processor å¯¹è±¡çš„å¤§å°")]),t._v(" "),s("td",[t._v("-1 è¡¨ç¤ºä¸é™åˆ¶.å½“ä¸ä½¿ç”¨ servlet3.0 çš„å¼‚æ­¥å¤„ç†æƒ…å†µä¸‹: å¦‚æœé…ç½® Executor,é…ç½®ä¸º Executor çš„ maxThreads;å¦åˆ™é…ç½®ä¸º Connnector çš„ maxThreads. å¦‚æœä½¿ç”¨ Serlvet3.0 å¼‚æ­¥å¤„ç†, å– maxThreads å’Œ maxConnections çš„æœ€å¤§å€¼")])])])]),t._v(" "),s("h4",{attrs:{id:"context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" Context")]),t._v(" "),s("blockquote",[s("p",[t._v("Context å…ƒç´ è¡¨ç¤ºä¸€ä¸ª Web åº”ç”¨ç¨‹åºï¼Œå®ƒåœ¨ç‰¹å®šçš„è™šæ‹Ÿä¸»æœºä¸­è¿è¡Œã€‚æ¯ä¸ª Web åº”ç”¨ç¨‹åºéƒ½åŸºäº Web åº”ç”¨ç¨‹åºå­˜æ¡£ï¼ˆWARï¼‰æ–‡ä»¶ï¼Œæˆ–è€…åŒ…å«ç›¸åº”çš„è§£åŒ…å†…å®¹çš„ç›¸åº”ç›®å½•ï¼Œå¦‚ Servlet è§„èŒƒä¸­æ‰€è¿°ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("è¯´æ˜")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("altDDName")]),t._v(" "),s("td",[t._v("web.xml éƒ¨ç½²æè¿°ç¬¦è·¯å¾„")]),t._v(" "),s("td",[t._v("é»˜è®¤ /WEB-INF/web.xml")])]),t._v(" "),s("tr",[s("td",[t._v("docBase")]),t._v(" "),s("td",[t._v("Context çš„ Root è·¯å¾„")]),t._v(" "),s("td",[t._v("å’Œ Host çš„ appBase ç›¸ç»“åˆ, å¯ç¡®å®š web åº”ç”¨çš„å®é™…ç›®å½•")])]),t._v(" "),s("tr",[s("td",[t._v("failCtxIfServletStartFails")]),t._v(" "),s("td",[t._v("åŒ Host ä¸­çš„ failCtxIfServletStartFails, åªå¯¹å½“å‰ Context æœ‰æ•ˆ")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º false")])]),t._v(" "),s("tr",[s("td",[t._v("logEffectiveWebXml")]),t._v(" "),s("td",[t._v("æ˜¯å¦æ—¥å¿—æ‰“å° web.xml å†…å®¹(web.xml ç”±é»˜è®¤çš„ web.xml å’Œåº”ç”¨ä¸­çš„ web.xml ç»„æˆ)")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º false")])]),t._v(" "),s("tr",[s("td",[t._v("path")]),t._v(" "),s("td",[t._v("web åº”ç”¨çš„ context path")]),t._v(" "),s("td",[t._v('å¦‚æœä¸ºæ ¹è·¯å¾„,åˆ™é…ç½®ä¸ºç©ºå­—ç¬¦ä¸²(""), ä¸èƒ½ä¸é…ç½®')])]),t._v(" "),s("tr",[s("td",[t._v("privileged")]),t._v(" "),s("td",[t._v("æ˜¯å¦ä½¿ç”¨ Tomcat æä¾›çš„ manager servlet")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("reloadable")]),t._v(" "),s("td",[t._v("/WEB-INF/classes/ å’Œ/WEB-INF/lib/ ç›®å½•ä¸­ class æ–‡ä»¶å‘ç”Ÿå˜åŒ–æ˜¯å¦è‡ªåŠ¨é‡æ–°åŠ è½½")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º false")])]),t._v(" "),s("tr",[s("td",[t._v("swallowOutput")]),t._v(" "),s("td",[t._v("true æƒ…å†µä¸‹, System.out å’Œ System.err è¾“å‡ºå°†è¢«å®šå‘åˆ° web åº”ç”¨æ—¥å¿—ä¸­")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º false")])])])]),t._v(" "),s("h4",{attrs:{id:"engine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#engine"}},[t._v("#")]),t._v(" Engine")]),t._v(" "),s("blockquote",[s("p",[t._v("Engine å…ƒç´ è¡¨ç¤ºä¸ç‰¹å®šçš„ Catalina æœåŠ¡ç›¸å…³è”çš„æ•´ä¸ªè¯·æ±‚å¤„ç†æœºå™¨ã€‚å®ƒæ¥æ”¶å¹¶å¤„ç†æ¥è‡ªä¸€ä¸ªæˆ–å¤šä¸ªè¿æ¥å™¨çš„æ‰€æœ‰è¯·æ±‚ï¼Œå¹¶å°†å®Œæˆçš„å“åº”è¿”å›ç»™è¿æ¥å™¨ï¼Œä»¥ä¾¿æœ€ç»ˆä¼ è¾“å›å®¢æˆ·ç«¯ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("æè¿°")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("defaultHost")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸»æœºåï¼Œç”¨äºæ ‡è¯†å°†å¤„ç†æŒ‡å‘æ­¤æœåŠ¡å™¨ä¸Šä¸»æœºåç§°ä½†æœªåœ¨æ­¤é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„è¯·æ±‚çš„ä¸»æœºã€‚")]),t._v(" "),s("td",[t._v("è¿™ä¸ªåå­—å¿…é¡»åŒ¹é…å…¶ä¸­ä¸€ä¸ªåµŒå¥—çš„ä¸»æœºå…ƒç´ çš„åå­—å±æ€§ã€‚")])]),t._v(" "),s("tr",[s("td",[t._v("name")]),t._v(" "),s("td",[t._v("æ­¤å¼•æ“çš„é€»è¾‘åç§°ï¼Œç”¨äºæ—¥å¿—å’Œé”™è¯¯æ¶ˆæ¯ã€‚")]),t._v(" "),s("td",[t._v("åœ¨åŒä¸€æœåŠ¡å™¨ä¸­ä½¿ç”¨å¤šä¸ªæœåŠ¡å…ƒç´ æ—¶ï¼Œæ¯ä¸ªå¼•æ“å¿…é¡»åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„åç§°ã€‚")])])])]),t._v(" "),s("h4",{attrs:{id:"host"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#host"}},[t._v("#")]),t._v(" Host")]),t._v(" "),s("blockquote",[s("p",[t._v("Host å…ƒç´ è¡¨ç¤ºä¸€ä¸ªè™šæ‹Ÿä¸»æœºï¼Œå®ƒæ˜¯ä¸€ä¸ªæœåŠ¡å™¨çš„ç½‘ç»œåç§°ï¼ˆå¦‚â€œwww.mycompany.comâ€ï¼‰ä¸è¿è¡Œ Tomcat çš„ç‰¹å®šæœåŠ¡å™¨çš„å…³è”ã€‚")])]),t._v(" "),s("p",[s("strong",[t._v("å±æ€§è¡¨")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("å±æ€§")]),t._v(" "),s("th",[t._v("è¯´æ˜")]),t._v(" "),s("th",[t._v("å¤‡æ³¨")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("name")]),t._v(" "),s("td",[t._v("åç§°")]),t._v(" "),s("td",[t._v("ç”¨äºæ—¥å¿—è¾“å‡º")])]),t._v(" "),s("tr",[s("td",[t._v("appBase")]),t._v(" "),s("td",[t._v("è™šæ‹Ÿä¸»æœºå¯¹åº”çš„åº”ç”¨åŸºç¡€è·¯å¾„")]),t._v(" "),s("td",[t._v("å¯ä»¥æ˜¯ä¸ªç»å¯¹è·¯å¾„, æˆ–${CATALINA_BASE}ç›¸å¯¹è·¯å¾„")])]),t._v(" "),s("tr",[s("td",[t._v("xmlBase")]),t._v(" "),s("td",[t._v("è™šæ‹Ÿä¸»æœº XML åŸºç¡€è·¯å¾„,é‡Œé¢åº”è¯¥æœ‰ Context xml é…ç½®æ–‡ä»¶")]),t._v(" "),s("td",[t._v("å¯ä»¥æ˜¯ä¸ªç»å¯¹è·¯å¾„, æˆ–${CATALINA_BASE}ç›¸å¯¹è·¯å¾„")])]),t._v(" "),s("tr",[s("td",[t._v("createDirs")]),t._v(" "),s("td",[t._v("å½“ appBase å’Œ xmlBase ä¸å­˜åœ¨æ—¶,æ˜¯å¦åˆ›å»ºç›®å½•")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º true")])]),t._v(" "),s("tr",[s("td",[t._v("autoDeploy")]),t._v(" "),s("td",[t._v("æ˜¯å¦å‘¨æœŸæ€§çš„æ£€æŸ¥ appBase å’Œ xmlBase å¹¶ deploy web åº”ç”¨å’Œ context æè¿°ç¬¦")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º true")])]),t._v(" "),s("tr",[s("td",[t._v("deployIgnore")]),t._v(" "),s("td",[t._v("å¿½ç•¥ deploy çš„æ­£åˆ™")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("deployOnStartup")]),t._v(" "),s("td",[t._v("Tomcat å¯åŠ¨æ—¶æ˜¯å¦è‡ªåŠ¨ deploy")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º true")])]),t._v(" "),s("tr",[s("td",[t._v("failCtxIfServletStartFails")]),t._v(" "),s("td",[t._v("é…ç½®ä¸º true æƒ…å†µä¸‹,ä»»ä½• load-on-startup >=0 çš„ servlet å¯åŠ¨å¤±è´¥,åˆ™å…¶å¯¹åº”çš„ Contxt ä¹Ÿå¯åŠ¨å¤±è´¥")]),t._v(" "),s("td",[t._v("é»˜è®¤ä¸º false")])])])]),t._v(" "),s("h4",{attrs:{id:"cluster"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cluster"}},[t._v("#")]),t._v(" Cluster")]),t._v(" "),s("p",[t._v("ç”±äºåœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»æœªç”¨è¿‡ Tomcat é›†ç¾¤é…ç½®ï¼Œæ‰€ä»¥æ²¡ç ”ç©¶ã€‚")]),t._v(" "),s("h3",{attrs:{id:"å¯åŠ¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¯åŠ¨"}},[t._v("#")]),t._v(" å¯åŠ¨")]),t._v(" "),s("h4",{attrs:{id:"éƒ¨ç½²æ–¹å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²æ–¹å¼"}},[t._v("#")]),t._v(" éƒ¨ç½²æ–¹å¼")]),t._v(" "),s("p",[t._v("è¿™ç§æ–¹å¼è¦æ±‚æœ¬åœ°å¿…é¡»å®‰è£… Tomcat ã€‚")]),t._v(" "),s("p",[t._v("å°†æ‰“åŒ…å¥½çš„ war åŒ…æ”¾åœ¨ Tomcat å®‰è£…ç›®å½•ä¸‹çš„ "),s("code",[t._v("webapps")]),t._v(" ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ bin ç›®å½•ä¸‹æ‰§è¡Œ "),s("code",[t._v("startup.bat")]),t._v(" æˆ– "),s("code",[t._v("startup.sh")]),t._v(" ï¼ŒTomcat ä¼šè‡ªåŠ¨è§£å‹ "),s("code",[t._v("webapps")]),t._v(" ç›®å½•ä¸‹çš„ war åŒ…ã€‚")]),t._v(" "),s("p",[t._v("æˆåŠŸåï¼Œå¯ä»¥è®¿é—® "),s("code",[t._v("http://localhost:8080/xxx")]),t._v(" ï¼ˆxxx æ˜¯ war åŒ…æ–‡ä»¶åï¼‰ã€‚")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("æ³¨æ„")])]),t._v(" "),s("p",[t._v("ä»¥ä¸Šæ­¥éª¤æ˜¯æœ€ç®€å•çš„ç¤ºä¾‹ã€‚æ­¥éª¤ä¸­çš„ war åŒ…è§£å‹è·¯å¾„ã€å¯åŠ¨ç«¯å£ä»¥åŠä¸€äº›æ›´å¤šçš„åŠŸèƒ½éƒ½å¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥å®šåˆ¶ ï¼ˆä¸»è¦æ˜¯ "),s("code",[t._v("server.xml")]),t._v(" æˆ– "),s("code",[t._v("context.xml")]),t._v(" æ–‡ä»¶ï¼‰ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"åµŒå…¥å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åµŒå…¥å¼"}},[t._v("#")]),t._v(" åµŒå…¥å¼")]),t._v(" "),s("h5",{attrs:{id:"api-æ–¹å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api-æ–¹å¼"}},[t._v("#")]),t._v(" API æ–¹å¼")]),t._v(" "),s("p",[t._v("åœ¨ pom.xml ä¸­æ·»åŠ ä¾èµ–")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.tomcat.embed"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("tomcat-embed-core"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("8.5.24"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("æ·»åŠ  SimpleEmbedTomcatServer.java æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("java"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Optional")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("org"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("apache"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("catalina"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tomcat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SimpleTomcatServer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" PORT "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" CONTEXT_PATH "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/javatool-server"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾å®š profile")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Optional")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" profile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Optional")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ofNullable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spring.profiles.active"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spring.profiles.active"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" profile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("orElse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"develop"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tomcat")]),t._v(" tomcat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tomcat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PORT"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHost")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setAppBase")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addWebapp")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CONTEXT_PATH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAbsolutePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"src/main/webapp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        tomcat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("await")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAbsolutePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" folderPath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SimpleEmbedTomcatServer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProtectionDomain")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCodeSource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLocation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("folderPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"target"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" folderPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" folderPath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"target"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("æˆåŠŸåï¼Œå¯ä»¥è®¿é—® "),s("code",[t._v("http://localhost:8080/javatool-server")]),t._v(" ã€‚")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("è¯´æ˜")])]),t._v(" "),s("p",[t._v("æœ¬ç¤ºä¾‹æ˜¯ä½¿ç”¨ "),s("code",[t._v("org.apache.tomcat.embed")]),t._v(" å¯åŠ¨åµŒå…¥å¼ Tomcat çš„æœ€ç®€ç¤ºä¾‹ã€‚")]),t._v(" "),s("p",[t._v("è¿™ä¸ªç¤ºä¾‹ä¸­ä½¿ç”¨çš„æ˜¯ Tomcat é»˜è®¤çš„é…ç½®ï¼Œä½†é€šå¸¸ï¼Œæˆ‘ä»¬éœ€è¦å¯¹ Tomcat é…ç½®è¿›è¡Œä¸€äº›å®šåˆ¶å’Œè°ƒä¼˜ã€‚ä¸ºäº†åŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨ç±»å°±è¦ç¨å¾®å†å¤æ‚ä¸€äº›ã€‚è¿™é‡Œä¸æƒ³å†è´´ä»£ç ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å‚è€ƒï¼š")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/dunwu/JavaStack/tree/master/codes/javatool/server",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("ç¤ºä¾‹é¡¹ç›®")]),s("OutboundLink")],1)])]),t._v(" "),s("h5",{attrs:{id:"ä½¿ç”¨-maven-æ’ä»¶å¯åŠ¨ï¼ˆä¸æ¨èï¼‰"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨-maven-æ’ä»¶å¯åŠ¨ï¼ˆä¸æ¨èï¼‰"}},[t._v("#")]),t._v(" ä½¿ç”¨ maven æ’ä»¶å¯åŠ¨ï¼ˆä¸æ¨èï¼‰")]),t._v(" "),s("p",[t._v("ä¸æ¨èç†ç”±ï¼šè¿™ç§æ–¹å¼å¯åŠ¨ maven è™½ç„¶æœ€ç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜æ˜¯ï¼ŒçœŸçš„å¾ˆä¹…å¾ˆä¹…æ²¡å‘å¸ƒæ–°ç‰ˆæœ¬äº†ï¼ˆæœ€æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶é—´ï¼š2013-11-11ï¼‰ã€‚ä¸”è²Œä¼¼åªèƒ½æ‰¾åˆ° Tomcat6 ã€Tomcat7 æ’ä»¶ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("ä½¿ç”¨æ–¹æ³•")])]),t._v(" "),s("p",[t._v("åœ¨ pom.xml ä¸­å¼•å…¥æ’ä»¶")]),t._v(" "),s("div",{staticClass:"language-xml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("org.apache.tomcat.maven"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("tomcat7-maven-plugin"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("2.2"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("8080"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("/${project.artifactId}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("uriEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("UTF-8"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("uriEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("configuration")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("è¿è¡Œ "),s("code",[t._v("mvn tomcat7:run")]),t._v(" å‘½ä»¤ï¼Œå¯åŠ¨ Tomcatã€‚")]),t._v(" "),s("p",[t._v("æˆåŠŸåï¼Œå¯ä»¥è®¿é—® "),s("code",[t._v("http://localhost:8080/xxx")]),t._v(" ï¼ˆxxx æ˜¯ ${project.artifactId} æŒ‡å®šçš„é¡¹ç›®åï¼‰ã€‚")]),t._v(" "),s("h4",{attrs:{id:"ide-æ’ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ide-æ’ä»¶"}},[t._v("#")]),t._v(" IDE æ’ä»¶")]),t._v(" "),s("p",[t._v("å¸¸è§ Java IDE ä¸€èˆ¬éƒ½æœ‰å¯¹ Tomcat çš„æ”¯æŒã€‚")]),t._v(" "),s("p",[t._v("ä»¥ Intellij IDEA ä¸ºä¾‹ï¼Œæä¾›äº† "),s("strong",[t._v("Tomcat and TomEE Integration")]),t._v(" æ’ä»¶ï¼ˆä¸€èˆ¬é»˜è®¤ä¼šå®‰è£…ï¼‰ã€‚")]),t._v(" "),s("p",[s("strong",[t._v("ä½¿ç”¨æ­¥éª¤")])]),t._v(" "),s("ul",[s("li",[t._v("ç‚¹å‡» Run/Debug Configurations > New Tomcat Server > local ï¼Œæ‰“å¼€ Tomcat é…ç½®é¡µé¢ã€‚")]),t._v(" "),s("li",[t._v("ç‚¹å‡» Confiure... æŒ‰é’®ï¼Œè®¾ç½® Tomcat å®‰è£…è·¯å¾„ã€‚")]),t._v(" "),s("li",[t._v("ç‚¹å‡» Deployment æ ‡ç­¾é¡µï¼Œè®¾ç½®è¦å¯åŠ¨çš„åº”ç”¨ã€‚")]),t._v(" "),s("li",[t._v("è®¾ç½®å¯åŠ¨åº”ç”¨çš„ç«¯å£ã€JVM å‚æ•°ã€å¯åŠ¨æµè§ˆå™¨ç­‰ã€‚")]),t._v(" "),s("li",[t._v("æˆåŠŸåï¼Œå¯ä»¥è®¿é—® "),s("code",[t._v("http://localhost:8080/")]),t._v("ï¼ˆå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ url ä¸­è®¾ç½®ä¸Šä¸‹æ–‡åç§°ï¼‰ã€‚")])]),t._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/tomcat-intellij-run-config.png!zp",alt:"img"}})]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("è¯´æ˜")])]),t._v(" "),s("p",[t._v("ä¸ªäººè®¤ä¸ºè¿™ä¸ªæ’ä»¶ä¸å¦‚ Eclipse çš„ Tomcat æ’ä»¶å¥½ç”¨ï¼ŒEclipse çš„ Tomcat æ’ä»¶æ”¯æŒå¯¹ Tomcat xml é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ã€‚è€Œè¿™é‡Œï¼Œä½ åªèƒ½è‡ªå·±å» Tomcat å®‰è£…è·¯å¾„ä¸‹ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚")])]),t._v(" "),s("p",[t._v("æ–‡ä¸­çš„åµŒå…¥å¼å¯åŠ¨ç¤ºä¾‹å¯ä»¥å‚è€ƒ"),s("a",{attrs:{href:"https://github.com/dunwu/JavaStack/tree/master/codes/javatool/server",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("æˆ‘çš„ç¤ºä¾‹é¡¹ç›®")]),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"tomcat-å·¥ä½œåŸç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-å·¥ä½œåŸç†"}},[t._v("#")]),t._v(" Tomcat å·¥ä½œåŸç†")]),t._v(" "),s("h3",{attrs:{id:"tomcat-ä¸»è¦ç»„ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-ä¸»è¦ç»„ä»¶"}},[t._v("#")]),t._v(" Tomcat ä¸»è¦ç»„ä»¶")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Tomcatä¸»è¦ç»„ä»¶.jpg!zp",width:"500"}})]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Server")]),t._v(" - æŒ‡çš„å°±æ˜¯æ•´ä¸ª Tomcat æœ åŠ¡å™¨ï¼ŒåŒ…å«å¤šç»„æœåŠ¡ï¼Œè´Ÿè´£ç®¡ç†å’Œ å¯åŠ¨å„ä¸ª Serviceï¼ŒåŒæ—¶ç›‘å¬ 8005 ç«¯å£å‘è¿‡æ¥çš„ shutdown å‘½ä»¤ï¼Œç”¨ äºå…³é—­æ•´ä¸ªå®¹å™¨ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Service")]),t._v(" - Tomcat å°è£…çš„ã€å¯¹å¤–æ ä¾›å®Œæ•´çš„ã€åŸºäºç»„ä»¶çš„ web æœåŠ¡ï¼Œ åŒ…å« Connectorsã€Container ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œä»¥åŠå¤šä¸ªåŠŸèƒ½ç»„ä»¶ï¼Œå„ ä¸ª Service ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œä½†æ˜¯å…±äº« åŒä¸€ JVM çš„èµ„æºã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Connector")]),t._v(" - Tomcat ä¸å¤–éƒ¨ä¸–ç•Œçš„è¿æ¥å™¨ï¼Œç›‘å¬å›ºå®šç«¯å£æ¥æ”¶å¤–éƒ¨è¯·æ±‚ï¼Œä¼ é€’ç»™ Containerï¼Œå¹¶ å°† Container å¤„ç†çš„ç»“æœè¿”å›ç»™å¤–éƒ¨ï¼›")]),t._v(" "),s("li",[s("strong",[t._v("Container")]),t._v(" - Catalinaï¼ŒServlet å®¹å™¨ï¼Œå†…éƒ¨æœ‰å¤šå±‚å®¹å™¨ç»„æˆï¼Œç”¨äºç®¡ç† Servlet ç”Ÿå‘½å‘¨æœŸï¼Œè°ƒç”¨ servlet ç›¸å…³æ–¹æ³•ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Loader")]),t._v(" - å°è£…äº† Java ClassLoaderï¼Œç”¨äº Container åŠ è½½ç±»æ–‡ä»¶ï¼› Realm - Tomcat ä¸­ä¸º web åº”ç”¨ç¨‹åºæä¾›è®¿é—®è®¤è¯å’Œè§’è‰²ç®¡ç†çš„æœºåˆ¶ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("JMX")]),t._v(" - Java SE ä¸­å®šä¹‰æŠ€æœ¯è§„èŒƒï¼Œæ˜¯ä¸€ä¸ªä¸ºåº”ç”¨ç¨‹åºã€è®¾å¤‡ã€ç³»ç»Ÿç­‰æ¤å…¥ç®¡ç†åŠŸèƒ½çš„æ¡†æ¶ï¼Œé€šè¿‡ JMX å¯ä»¥è¿œç¨‹ç›‘æ§ Tomcat çš„è¿è¡ŒçŠ¶æ€ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Jasper")]),t._v(" - Tomcat çš„ Jsp è§£æå¼•æ“ï¼Œç”¨äºå°† Jsp è½¬æ¢æˆ Java æ–‡ä»¶ï¼Œå¹¶ç¼–è¯‘æˆ class æ–‡ä»¶ã€‚ Session - è´Ÿè´£ç®¡ç†å’Œåˆ›å»º sessionï¼Œä»¥åŠ Session çš„æŒä¹…åŒ–(å¯è‡ªå®šä¹‰)ï¼Œæ”¯æŒ session çš„é›†")]),t._v(" "),s("li",[t._v("ç¾¤ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Pipeline")]),t._v(" - åœ¨å®¹å™¨ä¸­å……å½“ç®¡é“çš„ä½œç”¨ï¼Œç®¡é“ä¸­å¯ä»¥è®¾ç½®å„ç§ valve(é˜€é—¨)ï¼Œè¯·æ±‚å’Œå“åº”åœ¨ç»ç”±ç®¡ é“ä¸­å„ä¸ªé˜€é—¨å¤„ç†ï¼Œæä¾›äº†ä¸€ç§çµæ´»å¯é…ç½®çš„å¤„ç†è¯·æ±‚å’Œå“åº”çš„æœºåˆ¶ã€‚")]),t._v(" "),s("li",[s("strong",[t._v("Naming")]),t._v(" - å‘½åæœåŠ¡ï¼ŒJNDIï¼Œ Java å‘½åå’Œç›®å½•æ¥å£ï¼Œæ˜¯ä¸€ç»„åœ¨ Java åº”ç”¨ä¸­è®¿é—®å‘½åå’Œç›®å½•æœåŠ¡çš„ APIã€‚å‘½åæœåŠ¡å°†åç§°å’Œå¯¹è±¡è”ç³»èµ·æ¥ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨åç§°è®¿é—®å¯¹è±¡ï¼Œç›®å½•æœåŠ¡ä¹Ÿæ˜¯ä¸€ç§å‘½å æœåŠ¡ï¼Œå¯¹è±¡ä¸ä½†æœ‰åç§°ï¼Œè¿˜æœ‰å±æ€§ã€‚Tomcat ä¸­å¯ä»¥ä½¿ç”¨ JNDI å®šä¹‰æ•°æ®æºã€é…ç½®ä¿¡æ¯ï¼Œç”¨äºå¼€å‘ ä¸éƒ¨ç½²çš„åˆ†ç¦»ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"container-ç»„ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#container-ç»„ä»¶"}},[t._v("#")]),t._v(" Container ç»„ä»¶")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Tomcat-Containerç»„ä»¶.jpg!zp",width:"400"}})]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Engine")]),t._v(" - Servlet çš„é¡¶å±‚å®¹å™¨ï¼ŒåŒ…å«ä¸€ ä¸ªæˆ–å¤šä¸ª Host å­å®¹å™¨ï¼›")]),t._v(" "),s("li",[s("strong",[t._v("Host")]),t._v(" - è™šæ‹Ÿä¸»æœºï¼Œè´Ÿè´£ web åº”ç”¨çš„éƒ¨ ç½²å’Œ Context çš„åˆ›å»ºï¼›")]),t._v(" "),s("li",[s("strong",[t._v("Context")]),t._v(" - Web åº”ç”¨ä¸Šä¸‹æ–‡ï¼ŒåŒ…å«å¤šä¸ª Wrapperï¼Œè´Ÿè´£ web é…ç½®çš„è§£æã€ç®¡ ç†æ‰€æœ‰çš„ Web èµ„æºï¼›")]),t._v(" "),s("li",[s("strong",[t._v("Wrapper")]),t._v(" - æœ€åº•å±‚çš„å®¹å™¨ï¼Œæ˜¯å¯¹ Servlet çš„å°è£…ï¼Œè´Ÿè´£ Servlet å®ä¾‹çš„åˆ› å»ºã€æ‰§è¡Œå’Œé”€æ¯ã€‚")])]),t._v(" "),s("h3",{attrs:{id:"tomcat-ç”Ÿå‘½å‘¨æœŸ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-ç”Ÿå‘½å‘¨æœŸ"}},[t._v("#")]),t._v(" Tomcat ç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),s("h4",{attrs:{id:"tomcat-ç”Ÿå‘½å‘¨æœŸç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-ç”Ÿå‘½å‘¨æœŸç®¡ç†"}},[t._v("#")]),t._v(" Tomcat ç”Ÿå‘½å‘¨æœŸç®¡ç†")]),t._v(" "),s("p",[t._v("Tomcat ä¸ºäº†æ–¹ä¾¿ç®¡ç†ç»„ä»¶å’Œå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®šä¹‰äº†ä»åˆ›å»ºã€å¯åŠ¨ã€åˆ°åœæ­¢ã€é”€æ¯å…± 12 ä¸­çŠ¶æ€ï¼Œtomcat ç”Ÿå‘½å‘¨æœŸç®¡ç†äº†å†…éƒ¨çŠ¶æ€å˜åŒ–çš„è§„åˆ™æ§åˆ¶ï¼Œç»„ä»¶å’Œå®¹å™¨åªéœ€å®ç°ç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸ æ–¹æ³•å³å¯å®Œæˆå„ç”Ÿå‘½å‘¨æœŸå†…çš„æ“ä½œ(initInternalã€startInternalã€stopInternalã€ destroyInternal)ï¼›")]),t._v(" "),s("p",[t._v("æ¯”å¦‚æ‰§è¡Œåˆå§‹åŒ–æ“ä½œæ—¶ï¼Œä¼šåˆ¤æ–­å½“å‰çŠ¶æ€æ˜¯å¦ Newï¼Œå¦‚æœä¸æ˜¯åˆ™æŠ›å‡ºç”Ÿå‘½å‘¨æœŸå¼‚å¸¸ï¼›æ˜¯çš„ è¯åˆ™è®¾ç½®å½“å‰çŠ¶æ€ä¸º Initializingï¼Œå¹¶æ‰§è¡Œ initInternal æ–¹æ³•ï¼Œç”±å­ç±»å®ç°ï¼Œæ–¹æ³•æ‰§è¡ŒæˆåŠŸåˆ™è®¾ç½®å½“ å‰çŠ¶æ€ä¸º Initializedï¼Œæ‰§è¡Œå¤±è´¥åˆ™è®¾ç½®ä¸º Failed çŠ¶æ€ï¼›")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Tomcatç”Ÿå‘½å‘¨æœŸ.jpg!zp",width:"600"}})]),t._v(" "),s("p",[t._v("Tomcat çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å¼•å…¥äº†äº‹ä»¶æœºåˆ¶ï¼Œåœ¨ç»„ä»¶æˆ–å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸçŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ä¼šé€š çŸ¥äº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬å™¨é€šè¿‡åˆ¤æ–­äº‹ä»¶çš„ç±»å‹æ¥è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚\näº‹ä»¶ç›‘å¬å™¨çš„æ·»åŠ å¯ä»¥åœ¨ server.xml æ–‡ä»¶ä¸­è¿›è¡Œé…ç½®;")]),t._v(" "),s("p",[t._v("Tomcat å„ç±»å®¹å™¨çš„é…ç½®è¿‡ç¨‹å°±æ˜¯é€šè¿‡æ·»åŠ  listener çš„æ–¹å¼æ¥è¿›è¡Œçš„ï¼Œä»è€Œè¾¾åˆ°é…ç½®é€»è¾‘ä¸ å®¹å™¨çš„è§£è€¦ã€‚å¦‚ EngineConfigã€HostConfigã€ContextConfigã€‚")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("EngineConfig")]),t._v(" - ä¸»è¦æ‰“å°å¯åŠ¨å’Œåœæ­¢æ—¥å¿—")]),t._v(" "),s("li",[s("strong",[t._v("HostConfig")]),t._v(" - ä¸»è¦å¤„ç†éƒ¨ç½²åº”ç”¨ï¼Œè§£æåº”ç”¨ META-INF/context.xml å¹¶åˆ›å»ºåº”ç”¨çš„ Contextã€‚")]),t._v(" "),s("li",[s("strong",[t._v("ContextConfig")]),t._v(" - ä¸»è¦è§£æå¹¶åˆå¹¶ web.xmlï¼Œæ‰«æåº”ç”¨çš„å„ç±» web èµ„æº (filterã€servletã€listener)ã€‚")])]),t._v(" "),s("h4",{attrs:{id:"tomcat-çš„å¯åŠ¨è¿‡ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-çš„å¯åŠ¨è¿‡ç¨‹"}},[t._v("#")]),t._v(" Tomcat çš„å¯åŠ¨è¿‡ç¨‹")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Tomcatå¯åŠ¨è¿‡ç¨‹.jpg!zp",width:"600"}})]),t._v(" "),s("p",[t._v("å¯åŠ¨ä» Tomcat æä¾›çš„ start.sh è„šæœ¬å¼€å§‹ï¼Œshell è„šæœ¬ä¼šè°ƒç”¨ Bootstrap çš„ main æ–¹æ³•ï¼Œå®é™… è°ƒç”¨äº† Catalina ç›¸åº”çš„ loadã€start æ–¹æ³•ã€‚")]),t._v(" "),s("p",[t._v("load æ–¹æ³•ä¼šé€šè¿‡ Digester è¿›è¡Œ config/server.xml çš„è§£æï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šæ ¹æ® xml ä¸­çš„å…³ç³» å’Œé…ç½®ä¿¡æ¯æ¥åˆ›å»ºå®¹å™¨ï¼Œå¹¶è®¾ç½®ç›¸å…³çš„å±æ€§ã€‚æ¥ç€ Catalina ä¼šè°ƒç”¨ StandardServer çš„ init å’Œ start æ–¹æ³•è¿›è¡Œå®¹å™¨çš„åˆå§‹åŒ–å’Œå¯åŠ¨ã€‚")]),t._v(" "),s("p",[t._v("æŒ‰ç…§ xml çš„é…ç½®å…³ç³»ï¼Œserver çš„å­å…ƒç´ æ˜¯ serviceï¼Œservice çš„å­å…ƒç´ æ˜¯é¡¶å±‚å®¹å™¨ Engineï¼Œæ¯å±‚å®¹å™¨æœ‰æŒæœ‰è‡ªå·±çš„å­å®¹å™¨ï¼Œè€Œè¿™äº›å…ƒç´ éƒ½å®ç°äº†ç”Ÿå‘½å‘¨æœŸç®¡ç† çš„å„ä¸ªæ–¹æ³•ï¼Œå› æ­¤å°±å¾ˆå®¹æ˜“çš„å®Œæˆæ•´ä¸ªå®¹å™¨çš„å¯åŠ¨ã€å…³é—­ç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚")]),t._v(" "),s("p",[t._v("StandardServer å®Œæˆ init å’Œ start æ–¹æ³•è°ƒç”¨åï¼Œä¼šä¸€ç›´ç›‘å¬æ¥è‡ª 8005 ç«¯å£(å¯é…ç½®)ï¼Œå¦‚æœæ¥æ”¶ åˆ° shutdown å‘½ä»¤ï¼Œåˆ™ä¼šé€€å‡ºå¾ªç¯ç›‘å¬ï¼Œæ‰§è¡Œåç»­çš„ stop å’Œ destroy æ–¹æ³•ï¼Œå®Œæˆ Tomcat å®¹å™¨çš„ å…³é—­ã€‚åŒæ—¶ä¹Ÿä¼šè°ƒç”¨ JVM çš„ Runtime.getRuntime()ï´¿.addShutdownHook æ–¹æ³•ï¼Œåœ¨è™šæ‹Ÿæœºæ„å¤–é€€ å‡ºçš„æ—¶å€™æ¥å…³é—­å®¹å™¨ã€‚")]),t._v(" "),s("p",[t._v("æ‰€æœ‰å®¹å™¨éƒ½æ˜¯ç»§æ‰¿è‡ª ContainerBaseï¼ŒåŸºç±»ä¸­å°è£…äº†å®¹å™¨ä¸­çš„é‡å¤å·¥ä½œï¼Œè´Ÿè´£å¯åŠ¨å®¹å™¨ç›¸å…³çš„ç»„ ä»¶ Loaderã€Loggerã€Managerã€Clusterã€Pipelineï¼Œå¯åŠ¨å­å®¹å™¨(çº¿ç¨‹æ± å¹¶å‘å¯åŠ¨å­å®¹å™¨ï¼Œé€šè¿‡ çº¿ç¨‹æ±  submit å¤šä¸ªçº¿ç¨‹ï¼Œè°ƒç”¨åè¿”å› Future å¯¹è±¡ï¼Œçº¿ç¨‹å†…éƒ¨å¯åŠ¨å­å®¹å™¨ï¼Œæ¥ç€è°ƒç”¨ Future å¯¹è±¡ çš„ get æ–¹æ³•æ¥ç­‰å¾…æ‰§è¡Œç»“æœ)ã€‚")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Future")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" results "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Future")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" children"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    results"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("startStopExecutor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("submit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StartChild")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("children"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" fail "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Future")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Void")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" result ï¼š results"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"containerBase.threadedStartFailed"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("ï¼Œ e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        fail "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h5",{attrs:{id:"web-åº”ç”¨çš„éƒ¨ç½²æ–¹å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-åº”ç”¨çš„éƒ¨ç½²æ–¹å¼"}},[t._v("#")]),t._v(" Web åº”ç”¨çš„éƒ¨ç½²æ–¹å¼")]),t._v(" "),s("p",[t._v("æ³¨ï¼šcatalina.homeï¼šå®‰è£…ç›®å½•;catalina.baseï¼šå·¥ä½œç›®å½•;é»˜è®¤å€¼ user.dir")]),t._v(" "),s("ul",[s("li",[t._v("Server.xml é…ç½® Host å…ƒç´ ï¼ŒæŒ‡å®š appBase å±æ€§ï¼Œé»˜è®¤$catalina.base/webapps/")]),t._v(" "),s("li",[t._v("Server.xml é…ç½® Context å…ƒç´ ï¼ŒæŒ‡å®š docBaseï¼Œå…ƒç´ ï¼ŒæŒ‡å®š web åº”ç”¨çš„è·¯å¾„")]),t._v(" "),s("li",[t._v("è‡ªå®šä¹‰é…ç½®ï¼šåœ¨$catalina.base/EngineName/HostName/XXX.xml é…ç½® Context å…ƒç´ ")])]),t._v(" "),s("p",[t._v("HostConfig ç›‘å¬äº† StandardHost å®¹å™¨çš„äº‹ä»¶ï¼Œåœ¨ start æ–¹æ³•ä¸­è§£æä¸Šè¿°é…ç½®æ–‡ä»¶ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ‰«æ appbase è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹å’Œ war åŒ…ï¼Œè§£æå„ä¸ªåº”ç”¨çš„ META-INF/context.xmlï¼Œå¹¶ åˆ›å»º StandardContextï¼Œå¹¶å°† Context åŠ å…¥åˆ° Host çš„å­å®¹å™¨ä¸­ã€‚")]),t._v(" "),s("li",[t._v("è§£æ$catalina.base/EngineName/HostName/ä¸‹çš„æ‰€æœ‰ Context é…ç½®ï¼Œæ‰¾åˆ°ç›¸åº” web åº” ç”¨çš„ä½ç½®ï¼Œè§£æå„ä¸ªåº”ç”¨çš„ META-INF/context.xmlï¼Œå¹¶åˆ›å»º StandardContextï¼Œå¹¶å°† Context åŠ å…¥åˆ° Host çš„å­å®¹å™¨ä¸­ã€‚")])]),t._v(" "),s("p",[t._v("æ³¨ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("HostConfig å¹¶æ²¡æœ‰å®é™…è§£æ Context.xmlï¼Œè€Œæ˜¯åœ¨ ContextConfig ä¸­è¿›è¡Œçš„ã€‚")]),t._v(" "),s("li",[t._v("HostConfig ä¸­ä¼šå®šæœŸæ£€æŸ¥ watched èµ„æºæ–‡ä»¶(context.xml é…ç½®æ–‡ä»¶)")])]),t._v(" "),s("p",[t._v("ContextConfig è§£æ context.xml é¡ºåºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å…ˆè§£æå…¨å±€çš„é…ç½® config/context.xml")]),t._v(" "),s("li",[t._v("ç„¶åè§£æ Host çš„é»˜è®¤é…ç½® EngineName/HostName/context.xml.default")]),t._v(" "),s("li",[t._v("æœ€åè§£æåº”ç”¨çš„ META-INF/context.xml")])]),t._v(" "),s("p",[t._v("ContextConfig è§£æ web.xml é¡ºåºï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å…ˆè§£æå…¨å±€çš„é…ç½® config/web.xml")]),t._v(" "),s("li",[t._v("ç„¶åè§£æ Host çš„é»˜è®¤é…ç½® EngineName/HostName/web.xml.default æ¥ç€è§£æåº”ç”¨çš„ MEB-INF/web.xml")]),t._v(" "),s("li",[t._v("æ‰«æåº”ç”¨ WEB-INF/lib/ä¸‹çš„ jar æ–‡ä»¶ï¼Œè§£æå…¶ä¸­çš„ META-INF/web-fragment.xml æœ€ååˆå¹¶ xml å°è£…æˆ WebXmlï¼Œå¹¶è®¾ç½® Context")])]),t._v(" "),s("p",[t._v("æ³¨ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("æ‰«æ web åº”ç”¨å’Œ jar ä¸­çš„æ³¨è§£(Filterã€Listenerã€Servlet)å°±æ˜¯ä¸Šè¿°æ­¥éª¤ä¸­è¿›è¡Œçš„ã€‚")]),t._v(" "),s("li",[t._v("å®¹å™¨çš„å®šæœŸæ‰§è¡Œï¼šbackgroundProcessï¼Œç”± ContainerBase æ¥å®ç°çš„ï¼Œå¹¶ä¸”åªæœ‰åœ¨é¡¶å±‚å®¹å™¨ ä¸­æ‰ä¼šå¼€å¯çº¿ç¨‹ã€‚(backgroundProcessorDelay=10 æ ‡å¿—ä½æ¥æ§åˆ¶)")])]),t._v(" "),s("h4",{attrs:{id:"è¯·æ±‚å¤„ç†è¿‡ç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¯·æ±‚å¤„ç†è¿‡ç¨‹"}},[t._v("#")]),t._v(" è¯·æ±‚å¤„ç†è¿‡ç¨‹")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/è¯·æ±‚å¤„ç†è¿‡ç¨‹.png!zp",width:"600"}})]),t._v(" "),s("ol",[s("li",[t._v("æ ¹æ® server.xml é…ç½®çš„æŒ‡å®šçš„ connector ä»¥åŠç«¯å£ç›‘å¬ httpã€æˆ–è€… ajp è¯·æ±‚")]),t._v(" "),s("li",[t._v("è¯·æ±‚åˆ°æ¥æ—¶å»ºç«‹è¿æ¥,è§£æè¯·æ±‚å‚æ•°,åˆ›å»º Request å’Œ Response å¯¹è±¡,è°ƒç”¨é¡¶å±‚å®¹å™¨ pipeline çš„ invoke æ–¹æ³•")]),t._v(" "),s("li",[t._v("å®¹å™¨ä¹‹é—´å±‚å±‚è°ƒç”¨,æœ€ç»ˆè°ƒç”¨ä¸šåŠ¡ servlet çš„ service æ–¹æ³•")]),t._v(" "),s("li",[t._v("Connector å°† response æµä¸­çš„æ•°æ®å†™åˆ° socket ä¸­")])]),t._v(" "),s("h4",{attrs:{id:"pipeline-ä¸-valve"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pipeline-ä¸-valve"}},[t._v("#")]),t._v(" Pipeline ä¸ Valve")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Pipelineä¸Valve.png!zp",width:"600"}})]),t._v(" "),s("p",[t._v("Pipeline å¯ä»¥ç†è§£ä¸ºç°å®ä¸­çš„ç®¡é“,Valve ä¸ºç®¡é“ä¸­çš„é˜€é—¨,Request å’Œ Response å¯¹è±¡åœ¨ç®¡é“ä¸­ ç»è¿‡å„ä¸ªé˜€é—¨çš„å¤„ç†å’Œæ§åˆ¶ã€‚")]),t._v(" "),s("p",[t._v("æ¯ä¸ªå®¹å™¨çš„ç®¡é“ä¸­éƒ½æœ‰ä¸€ä¸ªå¿…ä¸å¯å°‘çš„ basic valve,å…¶ä»–çš„éƒ½æ˜¯å¯é€‰çš„,basic valve åœ¨ç®¡é“ä¸­æœ€ åè°ƒç”¨,åŒæ—¶è´Ÿè´£è°ƒç”¨å­å®¹å™¨çš„ç¬¬ä¸€ä¸ª valveã€‚")]),t._v(" "),s("p",[t._v("Valve ä¸­ä¸»è¦çš„ä¸‰ä¸ªæ–¹æ³•:setNextã€getNextã€invoke;valve ä¹‹é—´çš„å…³ç³»æ˜¯å•å‘é“¾å¼ç»“æ„,æœ¬èº« invoke æ–¹æ³•ä¸­ä¼šè°ƒç”¨ä¸‹ä¸€ä¸ª valve çš„ invoke æ–¹æ³•ã€‚")]),t._v(" "),s("p",[t._v("å„å±‚å®¹å™¨å¯¹åº”çš„ basic valve åˆ†åˆ«æ˜¯ StandardEngineValveã€StandardHostValveã€ StandardContextValveã€StandardWrapperValveã€‚")]),t._v(" "),s("h3",{attrs:{id:"connector-æµç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connector-æµç¨‹"}},[t._v("#")]),t._v(" Connector æµç¨‹")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/connector.png!zp",width:"600"}})]),t._v(" "),s("h4",{attrs:{id:"é˜»å¡-io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é˜»å¡-io"}},[t._v("#")]),t._v(" é˜»å¡ IO")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/é˜»å¡IO.png!zp",width:"600"}})]),t._v(" "),s("h4",{attrs:{id:"éé˜»å¡-io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#éé˜»å¡-io"}},[t._v("#")]),t._v(" éé˜»å¡ IO")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/éé˜»å¡IO.png!zp",width:"600"}})]),t._v(" "),s("h4",{attrs:{id:"io-å¤šè·¯å¤ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#io-å¤šè·¯å¤ç”¨"}},[t._v("#")]),t._v(" IO å¤šè·¯å¤ç”¨")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/IOå¤šè·¯å¤ç”¨.png!zp",width:"600"}})]),t._v(" "),s("p",[t._v("é˜»å¡ä¸éé˜»å¡çš„åŒºåˆ«åœ¨äºè¿›è¡Œè¯»æ“ä½œå’Œå†™æ“ä½œçš„ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå¦‚æœæ­¤æ—¶å†…æ ¸æ€æ²¡æœ‰æ•°æ®å¯è¯»æˆ–è€…æ²¡æœ‰ç¼“å†²ç©ºé—´å¯å†™æ—¶ï¼Œæ˜¯å¦é˜»å¡ã€‚")]),t._v(" "),s("p",[t._v("IO å¤šè·¯å¤ç”¨çš„å¥½å¤„åœ¨äºå¯åŒæ—¶ç›‘å¬å¤šä¸ª socket çš„å¯è¯»å’Œå¯å†™äº‹ä»¶ï¼Œè¿™æ ·å°±èƒ½ä½¿å¾—åº”ç”¨å¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ª socketï¼Œé‡Šæ”¾äº†åº”ç”¨çº¿ç¨‹èµ„æºã€‚")]),t._v(" "),s("h4",{attrs:{id:"tomcat-å„ç±»-connector-å¯¹æ¯”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tomcat-å„ç±»-connector-å¯¹æ¯”"}},[t._v("#")]),t._v(" Tomcat å„ç±» Connector å¯¹æ¯”")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/Tomcatå„ç±»Connectorå¯¹æ¯”.jpg!zp",width:"500"}})]),t._v(" "),s("ul",[s("li",[t._v("JIOï¼šç”¨ java.io ç¼–å†™çš„ TCP æ¨¡å—ï¼Œé˜»å¡ IO")]),t._v(" "),s("li",[t._v("NIOï¼šç”¨ java.nio ç¼–å†™çš„ TCP æ¨¡å—ï¼Œéé˜»å¡ IOï¼Œï¼ˆIO å¤šè·¯å¤ç”¨ï¼‰")]),t._v(" "),s("li",[t._v("APRï¼šå…¨ç§° Apache Portable Runtimeï¼Œä½¿ç”¨ JNI çš„æ–¹å¼æ¥è¿›è¡Œè¯»å–æ–‡ä»¶ä»¥åŠè¿›è¡Œç½‘ç»œä¼ è¾“")])]),t._v(" "),s("p",[t._v("Apache Portable Runtime æ˜¯ä¸€ä¸ªé«˜åº¦å¯ç§»æ¤çš„åº“ï¼Œå®ƒæ˜¯ Apache HTTP Server 2.x çš„æ ¸å¿ƒã€‚ APR å…·æœ‰è®¸å¤šç”¨é€”ï¼ŒåŒ…æ‹¬è®¿é—®é«˜çº§ IO åŠŸèƒ½ï¼ˆå¦‚ sendfileï¼Œepoll å’Œ OpenSSLï¼‰ï¼Œæ“ä½œç³»ç»Ÿçº§åŠŸèƒ½ï¼ˆéšæœºæ•°ç”Ÿæˆï¼Œç³»ç»ŸçŠ¶æ€ç­‰ï¼‰å’Œæœ¬åœ°è¿›ç¨‹å¤„ç†ï¼ˆå…±äº«å†…å­˜ï¼ŒNT ç®¡é“å’Œ Unix å¥—æ¥å­—ï¼‰ã€‚")]),t._v(" "),s("p",[t._v("è¡¨æ ¼ä¸­å­—æ®µå«ä¹‰è¯´æ˜ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("Support Polling - æ˜¯å¦æ”¯æŒåŸºäº IO å¤šè·¯å¤ç”¨çš„ socket äº‹ä»¶è½®è¯¢")]),t._v(" "),s("li",[t._v("Polling Size - è½®è¯¢çš„æœ€å¤§è¿æ¥æ•°")]),t._v(" "),s("li",[t._v("Wait for next Request - åœ¨ç­‰å¾…ä¸‹ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå¤„ç†çº¿ç¨‹æ˜¯å¦é‡Šæ”¾ï¼ŒBIO æ˜¯æ²¡æœ‰é‡Šæ”¾çš„ï¼Œæ‰€ä»¥åœ¨ keep-alive=true çš„æƒ…å†µä¸‹å¤„ç†çš„å¹¶å‘è¿æ¥æ•°æœ‰é™")]),t._v(" "),s("li",[t._v("Read Request Headers - ç”±äº request header æ•°æ®è¾ƒå°‘ï¼Œå¯ä»¥ç”±å®¹å™¨æå‰è§£æå®Œæ¯•ï¼Œä¸éœ€è¦é˜»å¡")]),t._v(" "),s("li",[t._v("Read Request Body - è¯»å– request body çš„æ•°æ®æ˜¯åº”ç”¨ä¸šåŠ¡é€»è¾‘çš„äº‹æƒ…ï¼ŒåŒæ—¶ Servlet çš„é™åˆ¶ï¼Œæ˜¯éœ€è¦é˜»å¡è¯»å–çš„")]),t._v(" "),s("li",[t._v("Write Response - è·Ÿè¯»å– request body çš„é€»è¾‘ç±»ä¼¼ï¼ŒåŒæ ·éœ€è¦é˜»å¡å†™")])]),t._v(" "),s("p",[s("strong",[t._v("NIO å¤„ç†ç›¸å…³ç±»")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/NIOå¤„ç†ç›¸å…³ç±».jpg!zp",width:"500"}})]),t._v(" "),s("p",[t._v("Poller çº¿ç¨‹ä» EventQueue è·å– PollerEventï¼Œå¹¶æ‰§è¡Œ PollerEvent çš„ run æ–¹æ³•ï¼Œè°ƒç”¨ Selector çš„ select æ–¹æ³•ï¼Œå¦‚æœæœ‰å¯è¯»çš„ Socket åˆ™åˆ›å»º Http11NioProcessorï¼Œæ”¾å…¥åˆ°çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼›")]),t._v(" "),s("p",[t._v("CoyoteAdapter æ˜¯ Connector åˆ° Container çš„é€‚é…å™¨ï¼ŒHttp11NioProcessor è°ƒç”¨å…¶æä¾›çš„ service æ–¹æ³•ï¼Œå†…éƒ¨åˆ›å»º Request å’Œ Response å¯¹è±¡ï¼Œå¹¶è°ƒç”¨æœ€é¡¶å±‚å®¹å™¨çš„ Pipeline ä¸­çš„ç¬¬ä¸€ä¸ª Valve çš„ invoke æ–¹æ³•")]),t._v(" "),s("p",[t._v("Mapper ä¸»è¦å¤„ç† http url åˆ° servlet çš„æ˜ å°„è§„åˆ™çš„è§£æï¼Œå¯¹å¤–æä¾› map æ–¹æ³•")]),t._v(" "),s("h3",{attrs:{id:"comet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#comet"}},[t._v("#")]),t._v(" Comet")]),t._v(" "),s("p",[t._v("Comet æ˜¯ä¸€ç§ç”¨äº web çš„æ¨é€æŠ€æœ¯ï¼Œèƒ½ä½¿æœåŠ¡å™¨å®æ—¶åœ°å°†æ›´æ–°çš„ä¿¡æ¯ä¼ é€åˆ°å®¢æˆ·ç«¯ï¼Œè€Œæ— é¡»å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚\nåœ¨ WebSocket å‡ºæ¥ä¹‹å‰ï¼Œå¦‚æœä¸é€‚ç”¨ cometï¼Œåªèƒ½é€šè¿‡æµè§ˆå™¨ç«¯è½®è¯¢ Server æ¥æ¨¡æ‹Ÿå®ç°æœåŠ¡å™¨ç«¯æ¨é€ã€‚\nComet æ”¯æŒ servlet å¼‚æ­¥å¤„ç† IOï¼Œå½“è¿æ¥ä¸Šæ•°æ®å¯è¯»æ—¶è§¦å‘äº‹ä»¶ï¼Œå¹¶å¼‚æ­¥å†™æ•°æ®(é˜»å¡)")]),t._v(" "),s("p",[t._v("Tomcat è¦å®ç° Cometï¼Œåªéœ€ç»§æ‰¿ HttpServlet åŒæ—¶ï¼Œå®ç° CometProcessor æ¥å£")]),t._v(" "),s("ul",[s("li",[t._v("Beginï¼šæ–°çš„è¯·æ±‚è¿æ¥æ¥å…¥è°ƒç”¨ï¼Œå¯è¿›è¡Œä¸ Request å’Œ Response ç›¸å…³çš„å¯¹è±¡åˆå§‹åŒ–æ“ä½œï¼Œå¹¶ä¿å­˜ response å¯¹è±¡ï¼Œç”¨äºåç»­å†™å…¥æ•°æ®")]),t._v(" "),s("li",[t._v("Readï¼šè¯·æ±‚è¿æ¥æœ‰æ•°æ®å¯è¯»æ—¶è°ƒç”¨")]),t._v(" "),s("li",[t._v("Endï¼šå½“æ•°æ®å¯ç”¨æ—¶ï¼Œå¦‚æœè¯»å–åˆ°æ–‡ä»¶ç»“æŸæˆ–è€… response è¢«å…³é—­æ—¶åˆ™è¢«è°ƒç”¨")]),t._v(" "),s("li",[t._v("Errorï¼šåœ¨è¿æ¥ä¸Šå‘ç”Ÿå¼‚å¸¸æ—¶è°ƒç”¨ï¼Œæ•°æ®è¯»å–å¼‚å¸¸ã€è¿æ¥æ–­å¼€ã€å¤„ç†å¼‚å¸¸ã€socket è¶…æ—¶")])]),t._v(" "),s("p",[t._v("Noteï¼š")]),t._v(" "),s("ul",[s("li",[t._v("Readï¼šåœ¨ post è¯·æ±‚æœ‰æ•°æ®ï¼Œä½†åœ¨ begin äº‹ä»¶ä¸­æ²¡æœ‰å¤„ç†ï¼Œåˆ™ä¼šè°ƒç”¨ readï¼Œå¦‚æœ read æ²¡æœ‰è¯»å–æ•°æ®ï¼Œåœ¨ä¼šè§¦å‘ Error å›è°ƒï¼Œå…³é—­ socket")]),t._v(" "),s("li",[t._v("Endï¼šå½“ socket è¶…æ—¶ï¼Œå¹¶ä¸” response è¢«å…³é—­æ—¶ä¹Ÿä¼šè°ƒç”¨ï¼›server è¢«å…³é—­æ—¶è°ƒç”¨")]),t._v(" "),s("li",[t._v("Errorï¼šé™¤äº† socket è¶…æ—¶ä¸ä¼šå…³é—­ socketï¼Œå…¶ä»–éƒ½ä¼šå…³é—­ socket")]),t._v(" "),s("li",[t._v("End å’Œ Error æ—¶é—´è§¦å‘æ—¶åº”å…³é—­å½“å‰ comet ä¼šè¯ï¼Œå³è°ƒç”¨ CometEvent çš„ close æ–¹æ³•\nNoteï¼šåœ¨äº‹ä»¶è§¦å‘æ—¶è¦åšå¥½çº¿ç¨‹å®‰å…¨çš„æ“ä½œ")])]),t._v(" "),s("h3",{attrs:{id:"å¼‚æ­¥-servlet"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¼‚æ­¥-servlet"}},[t._v("#")]),t._v(" å¼‚æ­¥ Servlet")]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/ä¼ ç»ŸServletå¤„ç†æµç¨‹.png!zp"}})]),t._v(" "),s("p",[t._v("ä¼ ç»Ÿæµç¨‹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("é¦–å…ˆï¼ŒServlet æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œrequest æ•°æ®è§£æï¼›")]),t._v(" "),s("li",[t._v("æ¥ç€ï¼Œè°ƒç”¨ä¸šåŠ¡æ¥å£çš„æŸäº›æ–¹æ³•ï¼Œä»¥å®Œæˆä¸šåŠ¡å¤„ç†ï¼›")]),t._v(" "),s("li",[t._v("æœ€åï¼Œæ ¹æ®å¤„ç†çš„ç»“æœæäº¤å“åº”ï¼ŒServlet çº¿ç¨‹ç»“æŸ")])]),t._v(" "),s("div",{attrs:{align:"center"}},[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javaweb/tools/tomcat/å¼‚æ­¥Servletå¤„ç†æµç¨‹.png!zp"}})]),t._v(" "),s("p",[t._v("å¼‚æ­¥å¤„ç†æµç¨‹ï¼š")]),t._v(" "),s("ul",[s("li",[t._v("å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚")]),t._v(" "),s("li",[t._v("Servlet å®¹å™¨åˆ†é…ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†å®¹å™¨ä¸­çš„ä¸€ä¸ª servlet")]),t._v(" "),s("li",[t._v("servlet è°ƒç”¨ request.startAsync()ï¼Œä¿å­˜ AsyncContext, ç„¶åè¿”å›")]),t._v(" "),s("li",[t._v("ä»»ä½•æ–¹å¼å­˜åœ¨çš„å®¹å™¨çº¿ç¨‹éƒ½å°†é€€å‡ºï¼Œä½†æ˜¯ response ä»ç„¶ä¿æŒå¼€æ”¾")]),t._v(" "),s("li",[t._v("ä¸šåŠ¡çº¿ç¨‹ä½¿ç”¨ä¿å­˜çš„ AsyncContext æ¥å®Œæˆå“åº”ï¼ˆçº¿ç¨‹æ± ï¼‰")]),t._v(" "),s("li",[t._v("å®¢æˆ·ç«¯æ”¶åˆ°å“åº”")])]),t._v(" "),s("p",[t._v("Servlet çº¿ç¨‹å°†è¯·æ±‚è½¬äº¤ç»™ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹æ¥æ‰§è¡Œä¸šåŠ¡å¤„ç†ï¼Œçº¿ç¨‹æœ¬èº«è¿”å›è‡³å®¹å™¨ï¼Œæ­¤æ—¶ Servlet è¿˜æ²¡æœ‰ç”Ÿæˆå“åº”æ•°æ®ï¼Œå¼‚æ­¥çº¿ç¨‹å¤„ç†å®Œä¸šåŠ¡ä»¥åï¼Œå¯ä»¥ç›´æ¥ç”Ÿæˆå“åº”æ•°æ®ï¼ˆå¼‚æ­¥çº¿ç¨‹æ‹¥æœ‰ ServletRequest å’Œ ServletResponse å¯¹è±¡çš„å¼•ç”¨ï¼‰")]),t._v(" "),s("p",[s("strong",[t._v("ä¸ºä»€ä¹ˆ web åº”ç”¨ä¸­æ”¯æŒå¼‚æ­¥ï¼Ÿ")])]),t._v(" "),s("p",[t._v("æ¨å‡ºå¼‚æ­¥ï¼Œä¸»è¦æ˜¯é’ˆå¯¹é‚£äº›æ¯”è¾ƒè€—æ—¶çš„è¯·æ±‚ï¼šæ¯”å¦‚ä¸€æ¬¡ç¼“æ…¢çš„æ•°æ®åº“æŸ¥è¯¢ï¼Œä¸€æ¬¡å¤–éƒ¨ REST API è°ƒç”¨, æˆ–è€…æ˜¯å…¶ä»–ä¸€äº› I/O å¯†é›†å‹æ“ä½œã€‚è¿™ç§è€—æ—¶çš„è¯·æ±‚ä¼šå¾ˆå¿«çš„è€—å…‰ Servlet å®¹å™¨çš„çº¿ç¨‹æ± ï¼Œç»§è€Œå½±å“å¯æ‰©å±•æ€§ã€‚")]),t._v(" "),s("p",[t._v("Noteï¼šä»å®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹ï¼Œrequest ä»ç„¶åƒä»»ä½•å…¶ä»–çš„ HTTP çš„ request-response äº¤äº’ä¸€æ ·ï¼Œåªæ˜¯è€—è´¹äº†æ›´é•¿çš„æ—¶é—´è€Œå·²")]),t._v(" "),s("p",[s("strong",[t._v("å¼‚æ­¥äº‹ä»¶ç›‘å¬")])]),t._v(" "),s("ul",[s("li",[t._v("onStartAsyncï¼šRequest è°ƒç”¨ startAsync æ–¹æ³•æ—¶è§¦å‘")]),t._v(" "),s("li",[t._v("onCompleteï¼šsyncContext è°ƒç”¨ complete æ–¹æ³•æ—¶è§¦å‘")]),t._v(" "),s("li",[t._v("onErrorï¼šå¤„ç†è¯·æ±‚çš„è¿‡ç¨‹å‡ºç°å¼‚å¸¸æ—¶è§¦å‘")]),t._v(" "),s("li",[t._v("onTimeoutï¼šsocket è¶…æ—¶è§¦å‘")])]),t._v(" "),s("p",[t._v("Note :\nonError/ onTimeout è§¦å‘åï¼Œä¼šç´§æ¥ç€å›è°ƒ onComplete\nonComplete æ‰§è¡Œåï¼Œå°±ä¸å¯å†æ“ä½œ request å’Œ response")]),t._v(" "),s("h2",{attrs:{id:"èµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#èµ„æ–™"}},[t._v("#")]),t._v(" èµ„æ–™")]),t._v(" "),s("h3",{attrs:{id:"å®˜æ–¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å®˜æ–¹"}},[t._v("#")]),t._v(" å®˜æ–¹")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://tomcat.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat å®˜æ–¹ç½‘ç«™"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://wiki.apache.org/tomcat/FrontPage",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat Wiki"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://tomee.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomee å®˜æ–¹ç½‘ç«™"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"ç¬¬ä¸‰æ–¹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬ä¸‰æ–¹"}},[t._v("#")]),t._v(" ç¬¬ä¸‰æ–¹")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://www.oracle.com/webfolder/technetwork/tutorials/obe/java/basic_app_embedded_tomcat/basic_app-tomcat-embedded.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Creating a Web App with Bootstrap and Tomcat Embedded"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.im/post/58eb5fdda0bb9f00692a78fc",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat ç»„æˆä¸å·¥ä½œåŸç†"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.ibm.com/developerworks/cn/java/j-lo-tomcat1/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat å·¥ä½œåŸç†"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.ibm.com/developerworks/cn/java/j-lo-tomcat2/index.html?ca=drs-",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tomcat è®¾è®¡æ¨¡å¼åˆ†æ"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);